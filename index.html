<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DUET Cover Page Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --primary-color: #2c3e50; --accent-color: #27ae60; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f7f6; margin: 0; padding: 20px; display: flex; gap: 20px; }
        
        /* Form Styling */
        .form-container { width: 350px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); height: fit-content; position: sticky; top: 20px; }
        .form-container h2 { margin-top: 0; color: var(--primary-color); font-size: 20px; border-bottom: 2px solid var(--accent-color); padding-bottom: 10px; }
        .input-group { margin-bottom: 12px; }
        .input-group label { display: block; font-size: 13px; font-weight: bold; margin-bottom: 5px; color: #555; }
        .input-group input, .input-group select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        .btn-download { width: 100%; background: var(--accent-color); color: white; border: none; padding: 12px; border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        .btn-download:hover { background: #219150; }

        /* Cover Page Styling */
        #cover-page { width: 210mm; min-height: 297mm; background: white; padding: 20mm; box-sizing: border-box; box-shadow: 0 0 20px rgba(0,0,0,0.1); margin: auto; }
        .header { text-align: center; }
        .motto { color: #157347; font-weight: bold; font-size: 18px; margin-bottom: 5px; }
        .logo { width: 110px; margin: 10px 0; }
        .uni-name { font-size: 20px; font-weight: bold; margin: 5px 0; }
        .dept-name { font-size: 17px; font-weight: bold; margin-bottom: 30px; }
        
        .course-info { text-align: center; margin-bottom: 30px; }
        .course-info p { margin: 5px 0; font-size: 18px; font-weight: bold; text-decoration: underline; }

        .exp-section { margin-top: 30px; font-size: 16px; line-height: 1.6; }
        .submission-box { border: 2px solid #000; padding: 25px; margin-top: 40px; position: relative; }
        .sub-title { position: absolute; top: -14px; left: 20px; background: white; padding: 0 10px; font-weight: bold; }

        table { width: 100%; border-collapse: collapse; margin-top: 25px; }
        th, td { border: 1px solid black; padding: 10px; text-align: left; }
        .center { text-align: center; }

        @media print { body { background: none; padding: 0; } .form-container { display: none; } #cover-page { box-shadow: none; } }
    </style>
</head>
<body>

<div class="form-container">
    <h2>Update Information</h2>
    <div class="input-group">
        <label>Course Title</label>
        <input type="text" id="inCourseTitle" value="Electrical Machines-II Sessional" oninput="update()">
    </div>
    <div class="input-group">
        <label>Course Code</label>
        <input type="text" id="inCourseCode" value="EEE 2302" oninput="update()">
    </div>
    <div class="input-group">
        <label>Experiment No.</label>
        <input type="text" id="inExpNo" placeholder="e.g. 01" oninput="update()">
    </div>
    <div class="input-group">
        <label>Experiment Name</label>
        <input type="text" id="inExpName" placeholder="Enter name" oninput="update()">
    </div>
    <div class="input-group">
        <label>Student Name</label>
        <input type="text" id="inName" placeholder="Your Name" oninput="update()">
    </div>
    <div class="input-group">
        <label>Student ID</label>
        <input type="text" id="inID" placeholder="Your ID" oninput="update()">
    </div>
    <div class="input-group">
        <label>Session</label>
        <input type="text" id="inSession" value="2023-24" oninput="update()">
    </div>
    <div class="input-group">
        <label>Date of Submission</label>
        <input type="date" id="inSubDate" oninput="update()">
    </div>
    <button class="btn-download" onclick="generatePDF()">Download PDF</button>
</div>

<div id="cover-page">
    <div class="header">
        [span_0](start_span)<div class="motto">প্রযুক্তিই প্রগতি[span_0](end_span)</div>
        <img class="logo" src="https://upload.wikimedia.org/wikipedia/en/thumb/8/8b/Dhaka_University_of_Engineering_and_Technology_Logo.svg/1200px-Dhaka_University_of_Engineering_and_Technology_Logo.svg.png">
        [span_1](start_span)<div class="uni-name">Dhaka University of Engineering and Technology, Gazipur-1707[span_1](end_span)</div>
        [span_2](start_span)<div class="dept-name">Department of Electrical and Electronic Engineering[span_2](end_span)</div>
    </div>

    <div class="course-info">
        [span_3](start_span)<p>Course Title: <span id="outCourseTitle">Electrical Machines-II Sessional</span>[span_3](end_span)</p>
        [span_4](start_span)<p>Course Code: <span id="outCourseCode">EEE 2302</span>[span_4](end_span)</p>
    </div>

    <div class="exp-section">
        [span_5](start_span)<p><strong>Experiment No.:</strong> <span id="outExpNo">________</span>[span_5](end_span)</p>
        [span_6](start_span)<p><strong>Name of the Experiment:</strong> <span id="outExpName">____________________________________</span>[span_6](end_span)</p>
    </div>

    <div class="submission-box">
        [span_7](start_span)<div class="sub-title">Submitted by[span_7](end_span)</div>
        [span_8](start_span)<p><strong>Name:</strong> <span id="outName">___________________</span>[span_8](end_span)</p>
        [span_9](start_span)<p><strong>Department:</strong> EEE[span_9](end_span)</p>
        [span_10](start_span)<p><strong>Student ID:</strong> <span id="outID">___________________</span>[span_10](end_span)</p>
        [span_11](start_span)<p><strong>Group No:</strong> A[span_11](end_span)</p>
        [span_12](start_span)<p><strong>Year / Semester:</strong> 2<sup>nd</sup> / 1<sup>st</sup>[span_12](end_span)</p>
        [span_13](start_span)<p><strong>Session:</strong> <span id="outSession">2023-24</span>[span_13](end_span)</p>
    </div>

    <table>
        <tr>
            [span_14](start_span)<th class="center">Date of Allocation[span_14](end_span)</th>
            [span_15](start_span)<th class="center">Date of Submission[span_15](end_span)</th>
        </tr>
        <tr style="height: 45px;">
            <td class="center">D: ___ M: ___ Y: ___</td>
            <td class="center" id="outDateDisplay">D: ___ M: ___ Y: ___</td>
        </tr>
    </table>

    <table>
        <tr>
            [span_16](start_span)<th>Marks Allocated[span_16](end_span)</th>
            [span_17](start_span)<th>Marks Obtained[span_17](end_span)</th>
        </tr>
        <tr style="height: 60px;">
            <td></td>
            <td></td>
        </tr>
    </table>
</div>

<script>
    function update() {
        document.getElementById('outCourseTitle').innerText = document.getElementById('inCourseTitle').value;
        document.getElementById('outCourseCode').innerText = document.getElementById('inCourseCode').value;
        document.getElementById('outExpNo').innerText = document.getElementById('inExpNo').value || "________";
        document.getElementById('outExpName').innerText = document.getElementById('inExpName').value || "____________________________________";
        document.getElementById('outName').innerText = document.getElementById('inName').value || "___________________";
        document.getElementById('outID').innerText = document.getElementById('inID').value || "___________________";
        document.getElementById('outSession').innerText = document.getElementById('inSession').value;
        
        const dateVal = document.getElementById('inSubDate').value;
        if(dateVal) {
            const date = new Date(dateVal);
            document.getElementById('outDateDisplay').innerText = `D: ${date.getDate()} M: ${date.getMonth()+1} Y: ${date.getFullYear()}`;
        }
    }

    function generatePDF() {
        const element = document.getElementById('cover-page');
        const opt = {
            margin: 0,
            filename: 'DUET_Cover_Page.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };
        html2pdf().set(opt).from(element).save();
    }
</script>

</body>
</html>
